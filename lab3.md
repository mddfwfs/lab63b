# การทดลองที่ 3 เรื่อง การเขียนโปรแกรมเอ้าพุทสัญญาณดิจิทัล

## วัตถุประสงค์
1.เพื่อศึกษาการนำmicrocontrollerที่เขียนโปรแกรมแล้วนำไปประยุกต์ใช้

2.เพื่อศึกษาเกี่ยวกับการ run microcontroller

### อุปกรณ์ที่ใช้
1.คอมพิวเตอร์

2.microcontroller ESP01

3.อุปกรณ์ต่อ USB-Serial

4.อแดปเตอร์ที่ต่อสายพอร์ท 0 กับ 1

5.รีเรย์

6.ตัวโปรแกรมเอ้าพุตสัญญาณ

7.ขั้วชาร์ต
#### ศึกษาข้อมูลเบื้องต้น
run relay https://www.youtube.com/watch?v=6JnhaUILGuw

รีเรย์ http://www.psptech.co.th/

03_Output-Port https://github.com/choompol-boonmee/lab63b/blob/master/examples/03_Output-Port/src/main.cpp


##### วิธีทำการทดลอง
1.เชื่อมต่อ อแดปเตอร์ เข้ากับคอมพิวเตอร์ด้วยการต่อ  USB ไปยัง Serial

2.นำ microcontroller เชื่อมต่อกับพอร์ท

3.เปิด cmd ใช้คำสั่งซึ่งจากตัวอย่างอยู่ในโฟล์เดอร์ pattani ใช้คำสั่ง cd

4.ใช้คำสั่ง cd 03_Output-Port

5.ใช้คำสั่ง vi src/main.cpp จะขึ้นโค้ดดังนี้

```
#include <Arduino.h>
#include <ESP8266WiFi.h>

int cnt = 0;

void setup()
{
	Serial.begin(115200);
	pinMode(0, OUTPUT);
	Serial.println("\n\n\n");
}

void loop()
{
	cnt++;
	if(cnt % 2) {
		Serial.println("========== ON ===========");
		digitalWrite(0, HIGH);
	} else {
		Serial.println("========== OFF ===========");
		digitalWrite(0, LOW);
	}
	delay(500);
}

```


โค้ดของโปรแกรมนี้ได้เซตที่พอร์ท 0 คือ พอร์ทเอ้าพุต และมีคำสั่งวนลูปทุกๆ 500 ms โดยจะนับ cnt ไปเรื่อยๆโดยที่เมือ cnt เลขคู่เป็น off และคี่เป็น on
ใช้คำสั่ง pio device monitor เพื่อเตรียมสแกนหา wifi

6.อัพโหลดโปรแกรมเข้าไมโครคอนโทรเลอร์โดยการใช้คำสั่ง pio run-t upload

7.กดปุ่มอัพโหลดและรีเซตที่ตัวไมโทรคอนโทรเลอร์เพื่อให้ตัวโปรแกรมอัพโหลดเข้าไปในตัว microcontroller

8.pio device monitor แล้วดูผลลัพท์

![image](https://user-images.githubusercontent.com/80880126/112264361-5c3d2100-8ca3-11eb-8945-d37c9caffd7d.png)


9.สังเกตหลอดไฟจะมีไฟเปิดและปิด

10.นำ microcontroller ที่เขียนโปรแกรมไว้แล้วมาต่อเข้ากับตัวรีเรย์

11.นำตัวรีเรย์ต่อเข้ากับขั้วชาร์ต

##### การบันทึกผลการทดลอง
1.การเขียนโปรแกรมไมโครคอนโทรลเลอร์ด้วยโปรแกรม Output-Port 
จะเห็นจากการใช้คำสั่ง pio device monitor จะมีคำสั่ง on off ทุก ๆ 500 ms 
ตามรหัสที่เราใส่ไว้ในโปรแกรมและเมื่อสังเกตไฟ LED ที่พอร์ต 0 จะสว่างและดับตามคำสั่ง on off เช่นกัน 
 
2.ใช้ไมโครคอนโทรลเลอร์ที่ตั้งโปรแกรมแล้วมาประยุกต์กับตัวรีเลย์คุณ จะเห็นว่าเมื่อต่อขั้วชาร์จจะเห็นว่ารีเลย์จะเปิดและปิดทันทีและสามารถได้ยินเสียงของหน้าสัมผัสของสวิตช์ไฟฟ้าที่เป็นโลหะ

##### อภิปรายผลการทดลอง
จากการทดลองนี้จะเห็นว่าเมื่อเราอัพเดตโปรแกรม 03 Output-Port ลงในไมโครคอนโทรลเลอร์และใช้คำสั่ง pio device monitor เพื่อดูการทำงานของไมโครคอนโทรลเลอร์ หน้าจอจะปรากฎ on และ off
ทุกๆ 500 ms ตามโค้ดที่เราใส่ลงในโปรแกรมและเมื่อสังเกตหลอดไฟ LED ที่พอร์ต 0 จะสว่างและดับตามคำสั่ง on off ตามโปรแกรมที่เราได้อัปโหลดและ
เมื่อนำไมโครคอนโทรลเลอร์นี้ไปใช้กับรีเลย์จะเห็นว่ารีเรย์จะเเปิดปิดสวิตช์สอดคล้องกับโค้ดที่เรา
ใส่ไว้ในตัวไมโครคอนโทรเลอร์

##### คำถามหลังการทดลอง
